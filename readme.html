<html>
	<head>
		<title>StunTour: SSL Enabler for mIRC</title>
	</head>
	<body>
		<h1 align="center">StunTour: SSL Enabler for mIRC</h1>
		<P align="center">homepage: <A href="http://www.bovine.net/~jlawson/coding/stuntour/">
				http://www.bovine.net/~jlawson/coding/stuntour/</A></P>
		<P>&nbsp;</P>
		<h2>Background</h2>
		<p>
			Being able to connect securely to SSL-enabled IRC chat servers is something 
			that remains difficult for most Win32 IRC applications. Very few IRC clients 
			natively support connecting to servers with SSL, and the few that do are 
			generally of very poor quality.
		</p>
		<p>
			If you want to securely use a client such as the popular Win32 <a href="http://www.mirc.com">
				mIRC</a> client, then you must generally resort to running a separate 
			tunneling application (such as <a href="http://www.stunnel.org/">stunnel</a>) 
			and then make mIRC to connect to a port bound to a localhost listening socket. 
			This has the added overhead of requiring another application to be running at 
			all times, and makes it difficult to change what server you connect to since 
			you must manipulate the destination of the tunnel application. Also, running an 
			external program is inconvenient and prone to problems.</p>
		<P></P>
		<h2>What is it?</h2>
		<p>
			After growing tired of fighting with stunnel, I decided to write a mIRC plugin 
			DLL that would natively allow it to connect to SSL-enabled IRC servers. 
			StunTour is a utility that automatically intercepts connections with 
			destination port of 994. This allows you to connect to IRC servers using a 
			secure SSL connection (provided that the server supports connecting over SSL on 
			port 994).
		</p>
		<p>There are currently very few IRC networks that support SSL connections. However, 
			one IRC network that this program has been tested with is <a href="http://www.cuckoo.com/irc/">
				CuckooNet IRC</a> (irc.cuckoo.net or irc.distributed.net), which is the IRC 
			network run primarily for the users of <a href="http://www.distributed.net">distributed.net</a>.</p>
		<P>Due to the hooking technique that is being used, this program is only compatible 
			with Windows 2000 and Windows XP machines.&nbsp; It will not work on Windows 
			95, Windows 98, or Windows Me.</P>
		<h2>How do I load it?</h2>
		<ol>
			<li>
				You can run the STUNRUN.EXE helper utility.
				<p>This causes mIRC to be automatically launched with the DLL pre-loaded. You 
					should ensure that mIRC is not already running when you do this.</p>
			<li>
				You can start MIRC.EXE as you normally would, but load the DLL manually in mIRC 
				with the command (before you connect):
				<pre>
	/dll stuntour.dll load_stunnel
</pre>
			<li>
				You can start MIRC.EXE as you normally would, but have the DLL loaded 
				automatically with scripting. Simply add this line to your "Remote" script tab:
				<pre>
        on *:start: { /dll stuntour.dll load_stunnel }
</pre>
				<p>
					Note that you cannot put a the dll load lines in the "Perform" script box since 
					those commands are run <i>after</i> mIRC successfully connects to the server.
				</p>
			</li>
		</ol>
		<p>
			If you use the manual loading techniques (methods 2 or 3) and want to unload 
			the library hooks manually for some reason without having to exit mIRC, use the 
			following command:
		</p>
		<pre>
	/dll -u stuntour.dll
</pre>
		<h2>Okay it's loaded, how do I use it?</h2>
		<p>StunTour is a automatically intercepts connections with destination port of 994. 
			Simply configure mIRC to directly connect to the IRC server on port 994 and 
			that connection will be automatically wrapped in an SSL encrypted tunnel.&nbsp; 
			Actually, StunTour currently allows any of the following ports to be used 
			(contact me if your IRC network uses a port that is not listed and I'll add 
			it):</p>
		<UL>
			<LI>
			994 (standard RFC allocated port for IRCS)
			<LI>
			7000, 7001, 7002, 7003 (blabber.net and others)
			<LI>
			6657&nbsp;(sirc.hu)
			<LI>
			6697 (axenet)
			<LI>
			9998, 9999 (suidnet, chatsages)
			<LI>
			6000 (wondernet)
			<LI>
				25401</LI>
		</UL>
		<H2>How does it work?</H2>
		<p>I'm using a the <a href="http://www.openssl.org/">OpenSSL</a> library for the 
			implementation of the encryption layer, and the <a href="http://research.microsoft.com/sn/detours/">
				Microsoft Detours</a> library to perform API interception/hooking on 
			several of the standard Winsock functions. From mIRC's perspective, it is still 
			opening an unencrypted connection to the server, but my code is doing the 
			necessary work to ensure that the actual connection is actually SSL encrypted. 
			I do this by using the Microsoft Detours library to intercept the Winsock <nobr>connect()</nobr>,
			<nobr>send()</nobr>, <nobr>recv()</nobr>, etc functions and making them utilize 
			the OpenSSL equivalents when a connection is made to a remote server on port 
			994.
		</p>
		<h2>Why is it named "stuntour"?</h2>
		<p>The name is simply a shortened contraction of "SSL tunnel detour". The word 
			"detour" is simply the name of the API hooking library that I'm using to 
			perform some of the critical network interception calls.</p>
		<hr>
		<address>Jeff Lawson &lt;jlawson@bovine.net&gt;</address>
	</body>
</html>
